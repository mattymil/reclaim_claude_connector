# Reclaim.ai MCP Connector for Claude

An AWS-based [Model Context Protocol (MCP)](https://modelcontextprotocol.io/) server that enables Claude to manage tasks in [Reclaim.ai](https://reclaim.ai) via OAuth 2.0 authenticated endpoints.

## What It Does

This connector allows Claude to:
- **Create and manage tasks** in Reclaim.ai that get automatically scheduled on your calendar
- **Search and filter tasks** by status, priority, due date, and more
- **Quick-capture ideas** to a GTD-style inbox for later processing
- **Track Otter.ai meeting exports** to prevent duplicate action item imports

## Architecture

```
Claude Desktop/API → MCP Protocol → API Gateway → Lambda → Reclaim.ai API
                          ↓
                    OAuth 2.0 + PKCE
```

### AWS Components

| Component | Purpose |
|-----------|---------|
| **API Gateway** | HTTP API with CORS for Claude origins |
| **Lambda Functions** | Node.js 20.x handlers for OAuth and MCP |
| **DynamoDB** | OAuth tokens, inbox items, processed meetings |
| **Secrets Manager** | API keys and OAuth client config |

---

## Setup

### Prerequisites

- Node.js 20.x
- AWS CLI configured with deployment credentials
- [AWS CDK](https://aws.amazon.com/cdk/) installed (`npm install -g aws-cdk`)
- A [Reclaim.ai](https://reclaim.ai) account with API access

### 1. Clone and Install

```bash
git clone https://github.com/mattymil/reclaim_claude_connector.git
cd reclaim_claude_connector
npm install
```

### 2. Get Your Reclaim.ai API Key

1. Log into [Reclaim.ai](https://app.reclaim.ai)
2. Go to **Settings → Integrations → API**
3. Generate a new API key

### 3. Deploy

```bash
npm run build
cdk bootstrap   # First time only
cdk deploy
```

CDK will create all resources including Secrets Manager secrets with placeholder values.

**Note the outputs** - CDK will display your API Gateway URLs after deployment.

### 4. Update Reclaim API Key

After deployment, update the secret with your actual Reclaim API key:

```bash
aws secretsmanager put-secret-value \
  --secret-id reclaim-api-key \
  --secret-string "YOUR_ACTUAL_RECLAIM_API_KEY"
```

The OAuth client secret is auto-generated by CDK - no action needed.

### 5. Configure Claude Desktop

Use the URLs from the CDK deployment output. Add to your Claude Desktop MCP configuration (`~/Library/Application Support/Claude/claude_desktop_config.json` on macOS):

```json
{
  "mcpServers": {
    "reclaim": {
      "url": "https://<your-api-id>.execute-api.<region>.amazonaws.com/mcp",
      "auth": {
        "type": "oauth",
        "authorizationUrl": "https://<your-api-id>.execute-api.<region>.amazonaws.com/authorize",
        "tokenUrl": "https://<your-api-id>.execute-api.<region>.amazonaws.com/token",
        "clientId": "reclaim-mcp-connector",
        "scopes": ["tasks:write"]
      }
    }
  }
}
```

Replace `<your-api-id>` and `<region>` with values from your CDK output.

---

## MCP Tools

### Task Management

#### `create_reclaim_task`

Create a task that Reclaim will automatically schedule.

| Parameter | Type | Required | Default | Description |
|-----------|------|----------|---------|-------------|
| `title` | string | Yes | — | Task title |
| `duration_minutes` | integer | No | 30 | Time needed (must be divisible by 15) |
| `priority` | string | No | LOW | `CRITICAL`, `HIGH`, `MEDIUM`, `LOW` |
| `category` | string | No | WORK | `WORK` or `PERSONAL` |
| `notes` | string | No | — | Task description |
| `due` | string | No | — | Due date (ISO 8601) |
| `schedule_after` | string | No | — | Don't schedule before this time (ISO 8601) |

#### `update_reclaim_task`

Update an existing task.

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `task_id` | integer | Yes | Task ID to update |
| `title` | string | No | New title |
| `duration_minutes` | integer | No | New duration (divisible by 15) |
| `priority` | string | No | New priority level |
| `notes` | string | No | New notes |
| `due` | string | No | New due date (ISO 8601) |
| `schedule_after` | string | No | New snooze date (ISO 8601) |
| `status` | string | No | `NEW`, `SCHEDULED`, `IN_PROGRESS`, `COMPLETE`, `CANCELLED` |

#### `list_reclaim_tasks`

List tasks with optional date filtering.

| Parameter | Type | Required | Default | Description |
|-----------|------|----------|---------|-------------|
| `start_date` | string | No | today | Start of range (ISO 8601) |
| `end_date` | string | No | +7 days | End of range (ISO 8601) |
| `status` | string | No | — | Filter by status |

#### `search_reclaim_tasks`

Flexible task search with multiple filters.

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `query` | string | No | Text search in titles |
| `status` | array | No | Filter by statuses |
| `priority` | array | No | Filter by priorities |
| `category` | string | No | `WORK` or `PERSONAL` |
| `has_due_date` | boolean | No | Filter by due date presence |
| `due_before` | string | No | Due before date (ISO 8601) |
| `due_after` | string | No | Due after date (ISO 8601) |
| `include_completed` | boolean | No | Include done/cancelled tasks |
| `limit` | integer | No | Max results (default 50) |

#### `get_scheduled_tasks`

Get tasks with their actual calendar times.

| Parameter | Type | Required | Default | Description |
|-----------|------|----------|---------|-------------|
| `start_date` | string | No | today | Start of range |
| `end_date` | string | No | +7 days | End of range |

---

### GTD Inbox

Quick capture for ideas to process later.

| Tool | Description |
|------|-------------|
| `add_to_inbox` | Capture a task idea (title, optional notes) |
| `list_inbox` | List unprocessed inbox items |
| `get_next_inbox_item` | Get oldest unprocessed item |
| `mark_inbox_processed` | Mark item as processed |

---

### Otter.ai Integration

Track which meetings have had action items exported to prevent duplicates.

> **Requires:** The [Otter.ai MCP server](https://mcp.otter.ai/mcp) must be connected to your Claude account to pull meeting data. This connector only tracks which meetings have been processed.

| Tool | Description |
|------|-------------|
| `get_processed_otter_meetings` | List already-exported meetings |
| `mark_otter_meeting_processed` | Mark meeting as exported |

**Workflow:** Claude uses Otter MCP to fetch meetings/action items, then uses this connector to add them to Reclaim and mark the meeting as processed.

---

## API Parameter Notes

**Duration:** Must be divisible by 15 (Reclaim uses 15-minute blocks).

**Priority mapping:**
- `CRITICAL` → P1
- `HIGH` → P2
- `MEDIUM` → P3
- `LOW` → P4

**Dates:** Use ISO 8601 format (e.g., `2024-01-15` or `2024-01-15T09:00:00-05:00`).

---

## Development

```bash
npm install          # Install dependencies
npm run build        # Compile TypeScript
npm run watch        # Watch mode
npm test             # Run tests
```

### CDK Commands

```bash
cdk synth            # Generate CloudFormation template
cdk diff             # Preview changes
cdk deploy           # Deploy to AWS
cdk destroy          # Tear down stack
```

---

## Security

- **PKCE required** for all OAuth flows
- **Tokens hashed** with SHA-256 before storage
- **Short-lived access tokens** (1 hour default)
- **Automatic cleanup** via DynamoDB TTL
- **Strict redirect URI validation**

---

## Troubleshooting

### "Token expired" errors
Access tokens expire after 1 hour. Claude should automatically refresh using the refresh token.

### "duration_minutes must be divisible by 15"
Reclaim schedules in 15-minute blocks. Use values like 15, 30, 45, 60, etc.

### Tasks not appearing in Reclaim
Check CloudWatch logs for the Lambda function. Common issues:
- Invalid API key
- Malformed date formats
- Missing required fields

---

## License

MIT

---

## Contributing

Contributions welcome! Please open an issue to discuss changes before submitting a PR.